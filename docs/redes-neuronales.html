<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Redes Neuronales | Analisis de Dow Jone Index para materia Analisis de series de tiempo</title>
  <meta name="description" content="10 Redes Neuronales | Analisis de Dow Jone Index para materia Analisis de series de tiempo" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Redes Neuronales | Analisis de Dow Jone Index para materia Analisis de series de tiempo" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Redes Neuronales | Analisis de Dow Jone Index para materia Analisis de series de tiempo" />
  
  
  

<meta name="author" content="Paula López" />


<meta name="date" content="2024-05-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelo-facebooks-prophet.html"/>
<link rel="next" href="comentarios-y-conclusión.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="exploracion-de-datos-eda.html"><a href="exploracion-de-datos-eda.html"><i class="fa fa-check"></i><b>2</b> Exploracion de datos: EDA</a></li>
<li class="chapter" data-level="3" data-path="creación-de-serie-temporal.html"><a href="creación-de-serie-temporal.html"><i class="fa fa-check"></i><b>3</b> Creación de serie temporal</a>
<ul>
<li class="chapter" data-level="3.1" data-path="creación-de-serie-temporal.html"><a href="creación-de-serie-temporal.html#determinar-la-frecuencia-de-la-serie-temporal"><i class="fa fa-check"></i><b>3.1</b> Determinar la frecuencia de la serie temporal</a></li>
<li class="chapter" data-level="3.2" data-path="creación-de-serie-temporal.html"><a href="creación-de-serie-temporal.html#crear-la-serie-temporal-con-frecuencia-semanal"><i class="fa fa-check"></i><b>3.2</b> Crear la serie temporal con frecuencia semanal</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="estructura-de-los-datos-en-series-de-tiempo.html"><a href="estructura-de-los-datos-en-series-de-tiempo.html"><i class="fa fa-check"></i><b>4</b> Estructura de los datos en series de tiempo</a>
<ul>
<li class="chapter" data-level="4.1" data-path="estructura-de-los-datos-en-series-de-tiempo.html"><a href="estructura-de-los-datos-en-series-de-tiempo.html#promedio-movil"><i class="fa fa-check"></i><b>4.1</b> Promedio movil</a></li>
<li class="chapter" data-level="4.2" data-path="estructura-de-los-datos-en-series-de-tiempo.html"><a href="estructura-de-los-datos-en-series-de-tiempo.html#rezagos"><i class="fa fa-check"></i><b>4.2</b> Rezagos</a></li>
<li class="chapter" data-level="4.3" data-path="estructura-de-los-datos-en-series-de-tiempo.html"><a href="estructura-de-los-datos-en-series-de-tiempo.html#estacionalidad"><i class="fa fa-check"></i><b>4.3</b> Estacionalidad</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="preprocesamiento.html"><a href="preprocesamiento.html"><i class="fa fa-check"></i><b>5</b> Preprocesamiento</a>
<ul>
<li class="chapter" data-level="5.1" data-path="preprocesamiento.html"><a href="preprocesamiento.html#estacionariedad"><i class="fa fa-check"></i><b>5.1</b> Estacionariedad</a></li>
<li class="chapter" data-level="5.2" data-path="preprocesamiento.html"><a href="preprocesamiento.html#diferenciación"><i class="fa fa-check"></i><b>5.2</b> Diferenciación</a></li>
<li class="chapter" data-level="5.3" data-path="preprocesamiento.html"><a href="preprocesamiento.html#transformación"><i class="fa fa-check"></i><b>5.3</b> Transformación</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modelo-arima.html"><a href="modelo-arima.html"><i class="fa fa-check"></i><b>6</b> Modelo ARIMA</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modelo-arima.html"><a href="modelo-arima.html#identificación-del-modelo-arima"><i class="fa fa-check"></i><b>6.1</b> Identificación del modelo ARIMA</a></li>
<li class="chapter" data-level="6.2" data-path="modelo-arima.html"><a href="modelo-arima.html#ajuste-del-modelo-arima"><i class="fa fa-check"></i><b>6.2</b> Ajuste del modelo ARIMA</a></li>
<li class="chapter" data-level="6.3" data-path="modelo-arima.html"><a href="modelo-arima.html#diagnóstico-del-modelo-arima"><i class="fa fa-check"></i><b>6.3</b> Diagnóstico del modelo ARIMA</a></li>
<li class="chapter" data-level="6.4" data-path="modelo-arima.html"><a href="modelo-arima.html#pronostico-del-modelo-arima"><i class="fa fa-check"></i><b>6.4</b> Pronostico del Modelo ARIMA</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modelo-holter_winter.html"><a href="modelo-holter_winter.html"><i class="fa fa-check"></i><b>7</b> Modelo Holter_Winter</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modelo-holter_winter.html"><a href="modelo-holter_winter.html#aplicación-el-modelo-holt-winters"><i class="fa fa-check"></i><b>7.1</b> Aplicación el modelo Holt-Winters</a></li>
<li class="chapter" data-level="7.2" data-path="modelo-holter_winter.html"><a href="modelo-holter_winter.html#suavizamiento-exponencial-simple"><i class="fa fa-check"></i><b>7.2</b> Suavizamiento Exponencial Simple</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="inclusion-de-variables-en-el-tiempo.html"><a href="inclusion-de-variables-en-el-tiempo.html"><i class="fa fa-check"></i><b>8</b> Inclusion de variables en el tiempo</a></li>
<li class="chapter" data-level="9" data-path="modelo-facebooks-prophet.html"><a href="modelo-facebooks-prophet.html"><i class="fa fa-check"></i><b>9</b> Modelo Facebook’s Prophet</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modelo-facebooks-prophet.html"><a href="modelo-facebooks-prophet.html#preparación-de-la-serie-temporal"><i class="fa fa-check"></i><b>9.1</b> Preparación de la serie temporal</a></li>
<li class="chapter" data-level="9.2" data-path="modelo-facebooks-prophet.html"><a href="modelo-facebooks-prophet.html#ajuste-del-modelo-prophet"><i class="fa fa-check"></i><b>9.2</b> Ajuste del modelo Prophet</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="redes-neuronales.html"><a href="redes-neuronales.html"><i class="fa fa-check"></i><b>10</b> Redes Neuronales</a>
<ul>
<li class="chapter" data-level="10.1" data-path="redes-neuronales.html"><a href="redes-neuronales.html#preparación-de-datos"><i class="fa fa-check"></i><b>10.1</b> Preparación de datos</a></li>
<li class="chapter" data-level="10.2" data-path="redes-neuronales.html"><a href="redes-neuronales.html#división-de-los-datos-en-conjuntos-de-entrenamiento-y-prueba"><i class="fa fa-check"></i><b>10.2</b> División de los datos en conjuntos de entrenamiento y prueba</a></li>
<li class="chapter" data-level="10.3" data-path="redes-neuronales.html"><a href="redes-neuronales.html#creación-de-la-matriz-de-entrada-y-aalida-para-la-red-neuronal"><i class="fa fa-check"></i><b>10.3</b> Creación de la matriz de entrada y aalida para la red neuronal</a></li>
<li class="chapter" data-level="10.4" data-path="redes-neuronales.html"><a href="redes-neuronales.html#entrenamiento-del-modelo-elman"><i class="fa fa-check"></i><b>10.4</b> Entrenamiento del modelo Elman</a></li>
<li class="chapter" data-level="10.5" data-path="redes-neuronales.html"><a href="redes-neuronales.html#desnormalización-y-visualización-de-resultados-del-modelo-elman"><i class="fa fa-check"></i><b>10.5</b> Desnormalización y visualización de resultados del modelo Elman</a></li>
<li class="chapter" data-level="10.6" data-path="redes-neuronales.html"><a href="redes-neuronales.html#entrenamiento-del-modelo-jordan"><i class="fa fa-check"></i><b>10.6</b> Entrenamiento del modelo Jordan</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="comentarios-y-conclusión.html"><a href="comentarios-y-conclusión.html"><i class="fa fa-check"></i><b>11</b> Comentarios y conclusión</a>
<ul>
<li class="chapter" data-level="11.1" data-path="comentarios-y-conclusión.html"><a href="comentarios-y-conclusión.html#comentarios"><i class="fa fa-check"></i><b>11.1</b> Comentarios</a></li>
<li class="chapter" data-level="11.2" data-path="comentarios-y-conclusión.html"><a href="comentarios-y-conclusión.html#conclusión"><i class="fa fa-check"></i><b>11.2</b> Conclusión</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analisis de Dow Jone Index para materia Analisis de series de tiempo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="redes-neuronales" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">10</span> Redes Neuronales<a href="redes-neuronales.html#redes-neuronales" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="preparación-de-datos" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Preparación de datos<a href="redes-neuronales.html#preparación-de-datos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Dividir los datos en conjuntos de entrenamiento y prueba, y normalizarlos si es necesario.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="redes-neuronales.html#cb73-1" tabindex="-1"></a><span class="co"># Cargar los paquetes necesarios</span></span>
<span id="cb73-2"><a href="redes-neuronales.html#cb73-2" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(RSNNS)) <span class="fu">install.packages</span>(<span class="st">&quot;RSNNS&quot;</span>)</span>
<span id="cb73-3"><a href="redes-neuronales.html#cb73-3" tabindex="-1"></a><span class="fu">library</span>(RSNNS)</span>
<span id="cb73-4"><a href="redes-neuronales.html#cb73-4" tabindex="-1"></a></span>
<span id="cb73-5"><a href="redes-neuronales.html#cb73-5" tabindex="-1"></a><span class="co"># Normalizar los datos</span></span>
<span id="cb73-6"><a href="redes-neuronales.html#cb73-6" tabindex="-1"></a>normalize <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb73-7"><a href="redes-neuronales.html#cb73-7" tabindex="-1"></a>  <span class="fu">return</span>((x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)))</span>
<span id="cb73-8"><a href="redes-neuronales.html#cb73-8" tabindex="-1"></a>}</span>
<span id="cb73-9"><a href="redes-neuronales.html#cb73-9" tabindex="-1"></a></span>
<span id="cb73-10"><a href="redes-neuronales.html#cb73-10" tabindex="-1"></a><span class="co"># Normalizar la columna de precios de cierre</span></span>
<span id="cb73-11"><a href="redes-neuronales.html#cb73-11" tabindex="-1"></a>data_ibm<span class="sc">$</span>close_normalized <span class="ot">&lt;-</span> <span class="fu">normalize</span>(data_ibm<span class="sc">$</span>close)</span>
<span id="cb73-12"><a href="redes-neuronales.html#cb73-12" tabindex="-1"></a></span>
<span id="cb73-13"><a href="redes-neuronales.html#cb73-13" tabindex="-1"></a><span class="co"># Verificar la normalización</span></span>
<span id="cb73-14"><a href="redes-neuronales.html#cb73-14" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(data_ibm<span class="sc">$</span>close_normalized))</span></code></pre></div>
<pre><code>## [1] 0.00000000 0.09139073 0.33421634 0.49801325 0.70949227 0.70286976</code></pre>
<p>.</p>
</div>
<div id="división-de-los-datos-en-conjuntos-de-entrenamiento-y-prueba" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> División de los datos en conjuntos de entrenamiento y prueba<a href="redes-neuronales.html#división-de-los-datos-en-conjuntos-de-entrenamiento-y-prueba" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="redes-neuronales.html#cb75-1" tabindex="-1"></a><span class="co"># Dividir los datos en conjuntos de entrenamiento y prueba</span></span>
<span id="cb75-2"><a href="redes-neuronales.html#cb75-2" tabindex="-1"></a>train_size <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fl">0.8</span> <span class="sc">*</span> <span class="fu">nrow</span>(data_ibm))</span>
<span id="cb75-3"><a href="redes-neuronales.html#cb75-3" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> data_ibm<span class="sc">$</span>close_normalized[<span class="dv">1</span><span class="sc">:</span>train_size]</span>
<span id="cb75-4"><a href="redes-neuronales.html#cb75-4" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> data_ibm<span class="sc">$</span>close_normalized[(train_size <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(data_ibm)]</span>
<span id="cb75-5"><a href="redes-neuronales.html#cb75-5" tabindex="-1"></a></span>
<span id="cb75-6"><a href="redes-neuronales.html#cb75-6" tabindex="-1"></a><span class="co"># Verificar las dimensiones de los conjuntos de datos</span></span>
<span id="cb75-7"><a href="redes-neuronales.html#cb75-7" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">length</span>(train_data))</span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="redes-neuronales.html#cb77-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">length</span>(test_data))</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>.</p>
</div>
<div id="creación-de-la-matriz-de-entrada-y-aalida-para-la-red-neuronal" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Creación de la matriz de entrada y aalida para la red neuronal<a href="redes-neuronales.html#creación-de-la-matriz-de-entrada-y-aalida-para-la-red-neuronal" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="redes-neuronales.html#cb79-1" tabindex="-1"></a><span class="co"># Definir lag como un valor numérico más pequeño</span></span>
<span id="cb79-2"><a href="redes-neuronales.html#cb79-2" tabindex="-1"></a>lag <span class="ot">&lt;-</span> <span class="dv">2</span>  <span class="co"># Reducir el lag para asegurar que hay suficientes datos en el conjunto de prueba</span></span>
<span id="cb79-3"><a href="redes-neuronales.html#cb79-3" tabindex="-1"></a></span>
<span id="cb79-4"><a href="redes-neuronales.html#cb79-4" tabindex="-1"></a><span class="co"># Crear la estructura de entrada y salida para la red neuronal</span></span>
<span id="cb79-5"><a href="redes-neuronales.html#cb79-5" tabindex="-1"></a>create_lagged_matrix <span class="ot">&lt;-</span> <span class="cf">function</span>(data, lag) {</span>
<span id="cb79-6"><a href="redes-neuronales.html#cb79-6" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(data)</span>
<span id="cb79-7"><a href="redes-neuronales.html#cb79-7" tabindex="-1"></a>  </span>
<span id="cb79-8"><a href="redes-neuronales.html#cb79-8" tabindex="-1"></a>  <span class="co"># Verificar si lag y n son numéricos</span></span>
<span id="cb79-9"><a href="redes-neuronales.html#cb79-9" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(lag)) {</span>
<span id="cb79-10"><a href="redes-neuronales.html#cb79-10" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;El valor de lag debe ser numérico. Valor actual: &quot;</span>, lag)</span>
<span id="cb79-11"><a href="redes-neuronales.html#cb79-11" tabindex="-1"></a>  }</span>
<span id="cb79-12"><a href="redes-neuronales.html#cb79-12" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(n)) {</span>
<span id="cb79-13"><a href="redes-neuronales.html#cb79-13" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;La longitud de los datos debe ser numérica. Valor actual: &quot;</span>, n)</span>
<span id="cb79-14"><a href="redes-neuronales.html#cb79-14" tabindex="-1"></a>  }</span>
<span id="cb79-15"><a href="redes-neuronales.html#cb79-15" tabindex="-1"></a>  </span>
<span id="cb79-16"><a href="redes-neuronales.html#cb79-16" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">&lt;=</span> lag) {</span>
<span id="cb79-17"><a href="redes-neuronales.html#cb79-17" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Los datos son insuficientes para crear la matriz con el lag especificado.&quot;</span>)</span>
<span id="cb79-18"><a href="redes-neuronales.html#cb79-18" tabindex="-1"></a>  }</span>
<span id="cb79-19"><a href="redes-neuronales.html#cb79-19" tabindex="-1"></a>  </span>
<span id="cb79-20"><a href="redes-neuronales.html#cb79-20" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> (n <span class="sc">-</span> lag), <span class="at">ncol =</span> lag)</span>
<span id="cb79-21"><a href="redes-neuronales.html#cb79-21" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n <span class="sc">-</span> lag)</span>
<span id="cb79-22"><a href="redes-neuronales.html#cb79-22" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (lag <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb79-23"><a href="redes-neuronales.html#cb79-23" tabindex="-1"></a>    X[i <span class="sc">-</span> lag, ] <span class="ot">&lt;-</span> data[(i <span class="sc">-</span> lag)<span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb79-24"><a href="redes-neuronales.html#cb79-24" tabindex="-1"></a>    y[i <span class="sc">-</span> lag] <span class="ot">&lt;-</span> data[i]</span>
<span id="cb79-25"><a href="redes-neuronales.html#cb79-25" tabindex="-1"></a>  }</span>
<span id="cb79-26"><a href="redes-neuronales.html#cb79-26" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X =</span> X, <span class="at">y =</span> y))</span>
<span id="cb79-27"><a href="redes-neuronales.html#cb79-27" tabindex="-1"></a>}</span>
<span id="cb79-28"><a href="redes-neuronales.html#cb79-28" tabindex="-1"></a></span>
<span id="cb79-29"><a href="redes-neuronales.html#cb79-29" tabindex="-1"></a><span class="co"># Dividir los datos en conjuntos de entrenamiento y prueba</span></span>
<span id="cb79-30"><a href="redes-neuronales.html#cb79-30" tabindex="-1"></a>train_size <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fl">0.8</span> <span class="sc">*</span> <span class="fu">nrow</span>(data_ibm))</span>
<span id="cb79-31"><a href="redes-neuronales.html#cb79-31" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> data_ibm<span class="sc">$</span>close_normalized[<span class="dv">1</span><span class="sc">:</span>train_size]</span>
<span id="cb79-32"><a href="redes-neuronales.html#cb79-32" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> data_ibm<span class="sc">$</span>close_normalized[(train_size <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(data_ibm)]</span>
<span id="cb79-33"><a href="redes-neuronales.html#cb79-33" tabindex="-1"></a></span>
<span id="cb79-34"><a href="redes-neuronales.html#cb79-34" tabindex="-1"></a><span class="co"># Verificar los valores de lag y n</span></span>
<span id="cb79-35"><a href="redes-neuronales.html#cb79-35" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Valor de lag:&quot;</span>, lag))</span></code></pre></div>
<pre><code>## [1] &quot;Valor de lag: 2&quot;</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="redes-neuronales.html#cb81-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Longitud de train_data:&quot;</span>, <span class="fu">length</span>(train_data)))</span></code></pre></div>
<pre><code>## [1] &quot;Longitud de train_data: 20&quot;</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="redes-neuronales.html#cb83-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Longitud de test_data:&quot;</span>, <span class="fu">length</span>(test_data)))</span></code></pre></div>
<pre><code>## [1] &quot;Longitud de test_data: 5&quot;</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="redes-neuronales.html#cb85-1" tabindex="-1"></a><span class="co"># Crear matrices de entrenamiento y prueba</span></span>
<span id="cb85-2"><a href="redes-neuronales.html#cb85-2" tabindex="-1"></a>train_matrix <span class="ot">&lt;-</span> <span class="fu">create_lagged_matrix</span>(train_data, lag)</span>
<span id="cb85-3"><a href="redes-neuronales.html#cb85-3" tabindex="-1"></a>test_matrix <span class="ot">&lt;-</span> <span class="fu">create_lagged_matrix</span>(test_data, lag)</span>
<span id="cb85-4"><a href="redes-neuronales.html#cb85-4" tabindex="-1"></a></span>
<span id="cb85-5"><a href="redes-neuronales.html#cb85-5" tabindex="-1"></a><span class="co"># Verificar las dimensiones de las matrices creadas</span></span>
<span id="cb85-6"><a href="redes-neuronales.html#cb85-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(train_matrix<span class="sc">$</span>X))</span></code></pre></div>
<pre><code>## [1] 18  2</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="redes-neuronales.html#cb87-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">length</span>(train_matrix<span class="sc">$</span>y))</span></code></pre></div>
<pre><code>## [1] 18</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="redes-neuronales.html#cb89-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(test_matrix<span class="sc">$</span>X))</span></code></pre></div>
<pre><code>## [1] 3 2</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="redes-neuronales.html#cb91-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">length</span>(test_matrix<span class="sc">$</span>y))</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>.</p>
</div>
<div id="entrenamiento-del-modelo-elman" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Entrenamiento del modelo Elman<a href="redes-neuronales.html#entrenamiento-del-modelo-elman" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="redes-neuronales.html#cb93-1" tabindex="-1"></a><span class="co"># Red Elman</span></span>
<span id="cb93-2"><a href="redes-neuronales.html#cb93-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Para reproducibilidad</span></span>
<span id="cb93-3"><a href="redes-neuronales.html#cb93-3" tabindex="-1"></a>elman_model <span class="ot">&lt;-</span> <span class="fu">elman</span>(train_matrix<span class="sc">$</span>X, train_matrix<span class="sc">$</span>y, <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="at">learnFuncParams =</span> <span class="fu">c</span>(<span class="fl">0.1</span>), <span class="at">maxit =</span> <span class="dv">1000</span>)</span>
<span id="cb93-4"><a href="redes-neuronales.html#cb93-4" tabindex="-1"></a></span>
<span id="cb93-5"><a href="redes-neuronales.html#cb93-5" tabindex="-1"></a><span class="co"># Predicción con el modelo Elman</span></span>
<span id="cb93-6"><a href="redes-neuronales.html#cb93-6" tabindex="-1"></a>elman_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(elman_model, test_matrix<span class="sc">$</span>X)</span>
<span id="cb93-7"><a href="redes-neuronales.html#cb93-7" tabindex="-1"></a></span>
<span id="cb93-8"><a href="redes-neuronales.html#cb93-8" tabindex="-1"></a><span class="co"># Verificar las predicciones</span></span>
<span id="cb93-9"><a href="redes-neuronales.html#cb93-9" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(elman_predictions))</span></code></pre></div>
<pre><code>##           [,1]
## [1,] 1.0021077
## [2,] 0.9856383
## [3,] 1.0090791</code></pre>
<p>.</p>
</div>
<div id="desnormalización-y-visualización-de-resultados-del-modelo-elman" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> Desnormalización y visualización de resultados del modelo Elman<a href="redes-neuronales.html#desnormalización-y-visualización-de-resultados-del-modelo-elman" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="redes-neuronales.html#cb95-1" tabindex="-1"></a><span class="co"># Desnormalizar las predicciones</span></span>
<span id="cb95-2"><a href="redes-neuronales.html#cb95-2" tabindex="-1"></a>denormalize <span class="ot">&lt;-</span> <span class="cf">function</span>(x, min_value, max_value) {</span>
<span id="cb95-3"><a href="redes-neuronales.html#cb95-3" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">*</span> (max_value <span class="sc">-</span> min_value) <span class="sc">+</span> min_value)</span>
<span id="cb95-4"><a href="redes-neuronales.html#cb95-4" tabindex="-1"></a>}</span>
<span id="cb95-5"><a href="redes-neuronales.html#cb95-5" tabindex="-1"></a></span>
<span id="cb95-6"><a href="redes-neuronales.html#cb95-6" tabindex="-1"></a>elman_predictions_denormalized <span class="ot">&lt;-</span> <span class="fu">denormalize</span>(elman_predictions, <span class="fu">min</span>(data_ibm<span class="sc">$</span>close), <span class="fu">max</span>(data_ibm<span class="sc">$</span>close))</span>
<span id="cb95-7"><a href="redes-neuronales.html#cb95-7" tabindex="-1"></a>test_data_denormalized <span class="ot">&lt;-</span> <span class="fu">denormalize</span>(test_matrix<span class="sc">$</span>y, <span class="fu">min</span>(data_ibm<span class="sc">$</span>close), <span class="fu">max</span>(data_ibm<span class="sc">$</span>close))</span>
<span id="cb95-8"><a href="redes-neuronales.html#cb95-8" tabindex="-1"></a></span>
<span id="cb95-9"><a href="redes-neuronales.html#cb95-9" tabindex="-1"></a><span class="co"># Visualizar los resultados</span></span>
<span id="cb95-10"><a href="redes-neuronales.html#cb95-10" tabindex="-1"></a><span class="fu">plot</span>(data_ibm<span class="sc">$</span>date[(train_size <span class="sc">+</span> lag <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(data_ibm)], test_data_denormalized, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb95-11"><a href="redes-neuronales.html#cb95-11" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Predicciones del Modelo Elman&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Fecha&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Precio de Cierre&quot;</span>)</span>
<span id="cb95-12"><a href="redes-neuronales.html#cb95-12" tabindex="-1"></a><span class="fu">lines</span>(data_ibm<span class="sc">$</span>date[(train_size <span class="sc">+</span> lag <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(data_ibm)], elman_predictions_denormalized, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb95-13"><a href="redes-neuronales.html#cb95-13" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Observado&quot;</span>, <span class="st">&quot;Predicción Elman&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="YAML_tarea-DJI_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>Comentarios:</p>
<ul>
<li><p>Creación de Matrices Laggeadas: Se utilizaron datos laggeados con un lag de 2 para capturar dependencias temporales.</p></li>
<li><p>Entrenamiento del Modelo Elman: La red Elman se entrenó con dos capas ocultas de 10 neuronas cada una durante 1000 iteraciones.</p></li>
<li><p>Predicción y Desnormalización: Las predicciones fueron desnormalizadas para compararlas con los valores reales.</p></li>
<li><p>Visualización de Resultados: La gráfica muestra que el modelo Elman sigue la tendencia de los datos observados, aunque hay diferencias que sugieren áreas de mejora.</p></li>
<li><p>Análisis Precisión: El modelo sigue razonablemente bien la tendencia, pero la precisión podría mejorar con más datos y ajustes.</p></li>
<li><p>Limitaciones: La serie temporal es corta y puede no capturar patrones complejos.
Usar más datos mejoraría el rendimiento del modelo.</p></li>
</ul>
<p>.</p>
<p>.</p>
</div>
<div id="entrenamiento-del-modelo-jordan" class="section level2 hasAnchor" number="10.6">
<h2><span class="header-section-number">10.6</span> Entrenamiento del modelo Jordan<a href="redes-neuronales.html#entrenamiento-del-modelo-jordan" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para implementar una red neuronal Jordan en el análisis de series temporales, realizamos un enfoque similar al utilizado con la red Elman, pero con algunas modificaciones específicas para la arquitectura de la red Jordan.
Se escribe codigo par realizar:</p>
<ul>
<li><p>Normalización de los datos de cierre.</p></li>
<li><p>Dividición los datos en conjuntos de entrenamiento y prueba.</p></li>
<li><p>Generación de matrices con datos laggeados para la entrada y salida.</p></li>
<li><p>Definición y entrenamiento de una red neuronal Jordan.</p></li>
<li><p>Realizar predicciones con el modelo entrenado.</p></li>
<li><p>Desnormalizar las predicciones.</p></li>
<li><p>Visualizar las predicciones comparadas con los datos reales.</p></li>
</ul>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="redes-neuronales.html#cb96-1" tabindex="-1"></a><span class="co"># Cargar los paquetes necesarios</span></span>
<span id="cb96-2"><a href="redes-neuronales.html#cb96-2" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(RSNNS)) <span class="fu">install.packages</span>(<span class="st">&quot;RSNNS&quot;</span>)</span>
<span id="cb96-3"><a href="redes-neuronales.html#cb96-3" tabindex="-1"></a><span class="fu">library</span>(RSNNS)</span>
<span id="cb96-4"><a href="redes-neuronales.html#cb96-4" tabindex="-1"></a></span>
<span id="cb96-5"><a href="redes-neuronales.html#cb96-5" tabindex="-1"></a><span class="co"># Normalizar los datos</span></span>
<span id="cb96-6"><a href="redes-neuronales.html#cb96-6" tabindex="-1"></a>normalize <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb96-7"><a href="redes-neuronales.html#cb96-7" tabindex="-1"></a>  <span class="fu">return</span>((x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)))</span>
<span id="cb96-8"><a href="redes-neuronales.html#cb96-8" tabindex="-1"></a>}</span>
<span id="cb96-9"><a href="redes-neuronales.html#cb96-9" tabindex="-1"></a></span>
<span id="cb96-10"><a href="redes-neuronales.html#cb96-10" tabindex="-1"></a><span class="co"># Normalizar la columna de precios de cierre</span></span>
<span id="cb96-11"><a href="redes-neuronales.html#cb96-11" tabindex="-1"></a>data_ibm<span class="sc">$</span>close_normalized <span class="ot">&lt;-</span> <span class="fu">normalize</span>(data_ibm<span class="sc">$</span>close)</span>
<span id="cb96-12"><a href="redes-neuronales.html#cb96-12" tabindex="-1"></a></span>
<span id="cb96-13"><a href="redes-neuronales.html#cb96-13" tabindex="-1"></a><span class="co"># Dividir los datos en conjuntos de entrenamiento y prueba</span></span>
<span id="cb96-14"><a href="redes-neuronales.html#cb96-14" tabindex="-1"></a>train_size <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fl">0.8</span> <span class="sc">*</span> <span class="fu">nrow</span>(data_ibm))</span>
<span id="cb96-15"><a href="redes-neuronales.html#cb96-15" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> data_ibm<span class="sc">$</span>close_normalized[<span class="dv">1</span><span class="sc">:</span>train_size]</span>
<span id="cb96-16"><a href="redes-neuronales.html#cb96-16" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> data_ibm<span class="sc">$</span>close_normalized[(train_size <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(data_ibm)]</span>
<span id="cb96-17"><a href="redes-neuronales.html#cb96-17" tabindex="-1"></a></span>
<span id="cb96-18"><a href="redes-neuronales.html#cb96-18" tabindex="-1"></a><span class="co"># Crear la estructura de entrada y salida para la red neuronal</span></span>
<span id="cb96-19"><a href="redes-neuronales.html#cb96-19" tabindex="-1"></a>create_lagged_matrix <span class="ot">&lt;-</span> <span class="cf">function</span>(data, lag) {</span>
<span id="cb96-20"><a href="redes-neuronales.html#cb96-20" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(data)</span>
<span id="cb96-21"><a href="redes-neuronales.html#cb96-21" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">&lt;=</span> lag) {</span>
<span id="cb96-22"><a href="redes-neuronales.html#cb96-22" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Los datos son insuficientes para crear la matriz con el lag especificado.&quot;</span>)</span>
<span id="cb96-23"><a href="redes-neuronales.html#cb96-23" tabindex="-1"></a>  }</span>
<span id="cb96-24"><a href="redes-neuronales.html#cb96-24" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> (n <span class="sc">-</span> lag), <span class="at">ncol =</span> lag)</span>
<span id="cb96-25"><a href="redes-neuronales.html#cb96-25" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n <span class="sc">-</span> lag)</span>
<span id="cb96-26"><a href="redes-neuronales.html#cb96-26" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (lag <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb96-27"><a href="redes-neuronales.html#cb96-27" tabindex="-1"></a>    X[i <span class="sc">-</span> lag, ] <span class="ot">&lt;-</span> data[(i <span class="sc">-</span> lag)<span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb96-28"><a href="redes-neuronales.html#cb96-28" tabindex="-1"></a>    y[i <span class="sc">-</span> lag] <span class="ot">&lt;-</span> data[i]</span>
<span id="cb96-29"><a href="redes-neuronales.html#cb96-29" tabindex="-1"></a>  }</span>
<span id="cb96-30"><a href="redes-neuronales.html#cb96-30" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X =</span> X, <span class="at">y =</span> y))</span>
<span id="cb96-31"><a href="redes-neuronales.html#cb96-31" tabindex="-1"></a>}</span>
<span id="cb96-32"><a href="redes-neuronales.html#cb96-32" tabindex="-1"></a></span>
<span id="cb96-33"><a href="redes-neuronales.html#cb96-33" tabindex="-1"></a><span class="co"># Verificar los valores de lag y n</span></span>
<span id="cb96-34"><a href="redes-neuronales.html#cb96-34" tabindex="-1"></a>lag <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb96-35"><a href="redes-neuronales.html#cb96-35" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Valor de lag:&quot;</span>, lag))</span>
<span id="cb96-36"><a href="redes-neuronales.html#cb96-36" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Longitud de train_data:&quot;</span>, <span class="fu">length</span>(train_data)))</span>
<span id="cb96-37"><a href="redes-neuronales.html#cb96-37" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Longitud de test_data:&quot;</span>, <span class="fu">length</span>(test_data)))</span>
<span id="cb96-38"><a href="redes-neuronales.html#cb96-38" tabindex="-1"></a></span>
<span id="cb96-39"><a href="redes-neuronales.html#cb96-39" tabindex="-1"></a><span class="co"># Crear matrices de entrenamiento y prueba</span></span>
<span id="cb96-40"><a href="redes-neuronales.html#cb96-40" tabindex="-1"></a>train_matrix <span class="ot">&lt;-</span> <span class="fu">create_lagged_matrix</span>(train_data, lag)</span>
<span id="cb96-41"><a href="redes-neuronales.html#cb96-41" tabindex="-1"></a>test_matrix <span class="ot">&lt;-</span> <span class="fu">create_lagged_matrix</span>(test_data, lag)</span>
<span id="cb96-42"><a href="redes-neuronales.html#cb96-42" tabindex="-1"></a></span>
<span id="cb96-43"><a href="redes-neuronales.html#cb96-43" tabindex="-1"></a><span class="co"># Verificar las dimensiones de las matrices creadas</span></span>
<span id="cb96-44"><a href="redes-neuronales.html#cb96-44" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(train_matrix<span class="sc">$</span>X))</span>
<span id="cb96-45"><a href="redes-neuronales.html#cb96-45" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">length</span>(train_matrix<span class="sc">$</span>y))</span>
<span id="cb96-46"><a href="redes-neuronales.html#cb96-46" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(test_matrix<span class="sc">$</span>X))</span>
<span id="cb96-47"><a href="redes-neuronales.html#cb96-47" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">length</span>(test_matrix<span class="sc">$</span>y))</span>
<span id="cb96-48"><a href="redes-neuronales.html#cb96-48" tabindex="-1"></a></span>
<span id="cb96-49"><a href="redes-neuronales.html#cb96-49" tabindex="-1"></a><span class="co"># Red Jordan</span></span>
<span id="cb96-50"><a href="redes-neuronales.html#cb96-50" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Para reproducibilidad</span></span>
<span id="cb96-51"><a href="redes-neuronales.html#cb96-51" tabindex="-1"></a>jordan_model <span class="ot">&lt;-</span> <span class="fu">jordan</span>(train_matrix<span class="sc">$</span>X, train_matrix<span class="sc">$</span>y, <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="at">learnFuncParams =</span> <span class="fu">c</span>(<span class="fl">0.1</span>), <span class="at">maxit =</span> <span class="dv">1000</span>)</span>
<span id="cb96-52"><a href="redes-neuronales.html#cb96-52" tabindex="-1"></a></span>
<span id="cb96-53"><a href="redes-neuronales.html#cb96-53" tabindex="-1"></a><span class="co"># Predicción con el modelo Jordan</span></span>
<span id="cb96-54"><a href="redes-neuronales.html#cb96-54" tabindex="-1"></a>jordan_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(jordan_model, test_matrix<span class="sc">$</span>X)</span>
<span id="cb96-55"><a href="redes-neuronales.html#cb96-55" tabindex="-1"></a></span>
<span id="cb96-56"><a href="redes-neuronales.html#cb96-56" tabindex="-1"></a><span class="co"># Desnormalizar las predicciones</span></span>
<span id="cb96-57"><a href="redes-neuronales.html#cb96-57" tabindex="-1"></a>denormalize <span class="ot">&lt;-</span> <span class="cf">function</span>(x, min_value, max_value) {</span>
<span id="cb96-58"><a href="redes-neuronales.html#cb96-58" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">*</span> (max_value <span class="sc">-</span> min_value) <span class="sc">+</span> min_value)</span>
<span id="cb96-59"><a href="redes-neuronales.html#cb96-59" tabindex="-1"></a>}</span>
<span id="cb96-60"><a href="redes-neuronales.html#cb96-60" tabindex="-1"></a></span>
<span id="cb96-61"><a href="redes-neuronales.html#cb96-61" tabindex="-1"></a>jordan_predictions_denormalized <span class="ot">&lt;-</span> <span class="fu">denormalize</span>(jordan_predictions, <span class="fu">min</span>(data_ibm<span class="sc">$</span>close), <span class="fu">max</span>(data_ibm<span class="sc">$</span>close))</span>
<span id="cb96-62"><a href="redes-neuronales.html#cb96-62" tabindex="-1"></a>test_data_denormalized <span class="ot">&lt;-</span> <span class="fu">denormalize</span>(test_matrix<span class="sc">$</span>y, <span class="fu">min</span>(data_ibm<span class="sc">$</span>close), <span class="fu">max</span>(data_ibm<span class="sc">$</span>close))</span>
<span id="cb96-63"><a href="redes-neuronales.html#cb96-63" tabindex="-1"></a></span>
<span id="cb96-64"><a href="redes-neuronales.html#cb96-64" tabindex="-1"></a><span class="co"># Visualizar los resultados</span></span>
<span id="cb96-65"><a href="redes-neuronales.html#cb96-65" tabindex="-1"></a><span class="fu">plot</span>(data_ibm<span class="sc">$</span>date[(train_size <span class="sc">+</span> lag <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(data_ibm)], test_data_denormalized, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb96-66"><a href="redes-neuronales.html#cb96-66" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Predicciones del Modelo Jordan&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Fecha&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Precio de Cierre&quot;</span>)</span>
<span id="cb96-67"><a href="redes-neuronales.html#cb96-67" tabindex="-1"></a><span class="fu">lines</span>(data_ibm<span class="sc">$</span>date[(train_size <span class="sc">+</span> lag <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(data_ibm)], jordan_predictions_denormalized, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb96-68"><a href="redes-neuronales.html#cb96-68" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Observado&quot;</span>, <span class="st">&quot;Predicción Jordan&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><strong><em>Processing file: Redes_neuronales.Rmd [unnamed-chunk-7]terminate called after throwing an instance of ‘Rcpp::not_compatible’ what(): Expecting a single value: [extent=2].</em></strong></p>
<p>A pesar de seguir todos los pasos necesarios para la implementación de una red neuronal Jordan en el análisis de series temporales, incluyendo la normalización de los datos, la división en conjuntos de entrenamiento y prueba, la generación de matrices laggeadas, y la configuración y entrenamiento del modelo, no fue posible ejecutar el modelo correctamente debido a un error persistente.
Específicamente, el error “Expecting a single value: [extent=2]” del paquete RSNNS indica problemas de compatibilidad con la estructura de los datos o la configuración del modelo en el entorno R utilizado.</p>
<p>Este error persistió incluso después de varios intentos de depuración y ajuste del código, así como de probar diferentes paquetes y enfoques.
Se intentó también usar otros paquetes como keras para la implementación del modelo Jordan, pero igualmente se encontraron problemas de compatibilidad y ejecución.
La limitación principal se relaciona con la sensibilidad del paquete RSNNS y otros paquetes probados a la estructura de los datos y la cantidad insuficiente de datos para entrenar adecuadamente un modelo Jordan.
Por lo tanto, se concluye que la implementación del modelo Jordan no es factible con las herramientas y datos disponibles en el entorno actual.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelo-facebooks-prophet.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="comentarios-y-conclusión.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
